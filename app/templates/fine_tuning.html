{% extends "base.html" %}

{% block title %}Fine-Tuning - AI Comedy Lab{% endblock %}

{% block content %}
<div class="text-center curtain-reveal">
    <div class="inline-block mb-8">
        <div class="text-9xl mb-6">‚öôÔ∏è</div>
    </div>

    <h1 class="text-6xl md:text-7xl font-black text-white mb-6 tracking-tight">
        <span class="gradient-text handwritten text-8xl">Fine-Tuning</span>
    </h1>

    <p class="text-2xl md:text-3xl font-light max-w-3xl mx-auto leading-relaxed mb-4" style="color: #FF6B9D;">
        Model Training & Customization
    </p>

    <p class="text-xl text-gray-300 max-w-4xl mx-auto leading-relaxed mb-8">
        Train custom models on comedian dialogues to make AI truly understand Tamil comedy nuances
        and speaking patterns.
    </p>

    <div class="max-w-2xl mx-auto mb-12">
        <div class="bg-blue-500/10 border border-blue-500/30 rounded-xl p-4 text-center">
            <p class="text-blue-300 text-sm">
                ‚ú® This feature uses <strong>OpenAI's API directly</strong> for fine-tuning (not OpenRouter)
            </p>
        </div>
    </div>
</div>

<!-- Tab Navigation -->
<div class="max-w-6xl mx-auto mb-8 curtain-reveal" style="animation-delay: 0.1s;">
    <div class="flex flex-wrap gap-3 justify-center">
        <button onclick="showTab('dataset')" id="tab-dataset" class="tab-btn active">
            üìä Dataset
        </button>
        <button onclick="showTab('training')" id="tab-training" class="tab-btn">
            üîß Training
        </button>
        <button onclick="showTab('jobs')" id="tab-jobs" class="tab-btn">
            üìã Jobs
        </button>
        <button onclick="showTab('chat')" id="tab-chat" class="tab-btn">
            üí¨ Chat
        </button>
        <button onclick="showTab('compare')" id="tab-compare" class="tab-btn">
            üîç Compare
        </button>
        <button onclick="showTab('explain')" id="tab-explain" class="tab-btn">
            üìö Learn
        </button>
    </div>
</div>

<!-- Dataset Tab -->
<div id="content-dataset" class="tab-content active">
    <div class="stage-container rounded-3xl p-8 max-w-4xl mx-auto curtain-reveal" style="animation-delay: 0.2s;">
        <h2 class="text-3xl font-bold text-white mb-6">Training Dataset</h2>

        <div id="dataset-stats" class="mb-6">
            <div class="text-center py-8">
                <div class="animate-spin inline-block w-8 h-8 border-4 border-pink-500 border-t-transparent rounded-full"></div>
                <p class="text-gray-400 mt-4">Loading dataset information...</p>
            </div>
        </div>

        <div class="bg-black/30 rounded-xl p-6 border border-white/10">
            <h3 class="text-xl font-bold text-white mb-4">What is this dataset?</h3>
            <p class="text-gray-300 leading-relaxed mb-4">
                The fine-tuning dataset contains dialogue examples from Tamil comedians (Vadivelu, Santhanam, Vivek)
                formatted in OpenAI's chat completion format. Each example includes a system prompt, user context,
                and the comedian's response in Tanglish.
            </p>
            <div class="bg-blue-500/10 border border-blue-500/30 rounded-lg p-3 text-sm">
                <p class="text-blue-300">
                    <strong>Note:</strong> Fine-tuning uses OpenAI's API directly. Make sure your OPENAI_API_KEY
                    is configured and you have billing enabled on your OpenAI account.
                </p>
            </div>
        </div>
    </div>
</div>

<!-- Training Tab -->
<div id="content-training" class="tab-content">
    <div class="stage-container rounded-3xl p-8 max-w-4xl mx-auto curtain-reveal" style="animation-delay: 0.2s;">
        <h2 class="text-3xl font-bold text-white mb-4">Start Fine-Tuning</h2>

        <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-4 mb-6">
            <p class="text-yellow-300 text-sm">
                <strong>‚ö†Ô∏è Cost Warning:</strong> OpenAI charges for fine-tuning. Training costs ~$0.008 per 1K tokens.
                A typical dataset of 100 dialogues costs ~$0.08 to train.
            </p>
        </div>

        <form id="training-form" class="space-y-6">
            <div>
                <label class="block text-white font-semibold mb-2">Model Name</label>
                <input type="text" id="model-name"
                       class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none"
                       placeholder="vadivelu_comedian_v1" required>
                <p class="text-gray-400 text-sm mt-1">Choose a unique name for your fine-tuned model</p>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                <div>
                    <label class="block text-white font-semibold mb-2">Epochs</label>
                    <input type="number" id="epochs" value="3" min="1" max="10"
                           class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none">
                </div>
                <div>
                    <label class="block text-white font-semibold mb-2">Batch Size</label>
                    <input type="number" id="batch-size" value="4" min="1" max="32"
                           class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none">
                </div>
                <div>
                    <label class="block text-white font-semibold mb-2">Learning Rate</label>
                    <input type="number" id="learning-rate" value="0.1" step="0.01" min="0.01" max="1"
                           class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none">
                </div>
            </div>

            <button type="submit" class="w-full px-8 py-4 rounded-xl font-semibold text-black transition-all"
                    style="background: linear-gradient(135deg, #FF6B9D, #FF1B7A); box-shadow: 0 4px 20px rgba(255, 107, 157, 0.3);">
                üöÄ Start Fine-Tuning
            </button>
        </form>

        <div id="training-result" class="mt-6 hidden"></div>
    </div>
</div>

<!-- Jobs Tab -->
<div id="content-jobs" class="tab-content">
    <div class="stage-container rounded-3xl p-8 max-w-6xl mx-auto curtain-reveal" style="animation-delay: 0.2s;">
        <div class="flex justify-between items-center mb-6">
            <h2 class="text-3xl font-bold text-white">Fine-Tuning Jobs</h2>
            <button onclick="loadJobs()" class="px-4 py-2 bg-pink-500/20 hover:bg-pink-500/30 text-pink-400 rounded-lg transition-all">
                üîÑ Refresh
            </button>
        </div>

        <div id="jobs-list">
            <div class="text-center py-8">
                <div class="animate-spin inline-block w-8 h-8 border-4 border-pink-500 border-t-transparent rounded-full"></div>
                <p class="text-gray-400 mt-4">Loading jobs...</p>
            </div>
        </div>
    </div>
</div>

<!-- Chat Tab -->
<div id="content-chat" class="tab-content">
    <div class="stage-container rounded-3xl p-8 max-w-4xl mx-auto curtain-reveal" style="animation-delay: 0.2s;">
        <h2 class="text-3xl font-bold text-white mb-6">Chat with Fine-Tuned Model</h2>

        <div class="mb-6">
            <label class="block text-white font-semibold mb-2">Fine-Tuned Model ID</label>
            <input type="text" id="chat-model-id"
                   class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none"
                   placeholder="ft:gpt-3.5-turbo-0125:specflux-solutions::Cr4saoQO">
            <p class="text-gray-400 text-sm mt-1">Get this from the Jobs tab after training completes</p>
        </div>

        <div class="mb-6">
            <label class="block text-white font-semibold mb-2">Comedian Style</label>
            <select id="chat-comedian"
                    class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none">
                <option value="vadivelu">Vadivelu (Exaggerated & Self-Deprecating)</option>
                <option value="santhanam">Santhanam (Quick Wit & Sarcasm)</option>
                <option value="vivek">Vivek (Intellectual & Social Commentary)</option>
            </select>
            <p class="text-gray-400 text-sm mt-1">Choose which comedian's style to use</p>
        </div>

        <div class="mb-6">
            <label class="block text-white font-semibold mb-2">Your Message</label>
            <textarea id="chat-message" rows="4"
                      class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none"
                      placeholder="Tell me a joke about traffic"></textarea>
        </div>

        <button onclick="sendChatMessage()" class="w-full px-8 py-4 rounded-xl font-semibold text-black transition-all"
                style="background: linear-gradient(135deg, #FF6B9D, #FF1B7A); box-shadow: 0 4px 20px rgba(255, 107, 157, 0.3);">
            üí¨ Send Message
        </button>

        <div id="chat-response" class="mt-6 hidden"></div>
    </div>
</div>

<!-- Compare Tab -->
<div id="content-compare" class="tab-content">
    <div class="stage-container rounded-3xl p-8 max-w-6xl mx-auto curtain-reveal" style="animation-delay: 0.2s;">
        <h2 class="text-3xl font-bold text-white mb-6">Compare Base vs Fine-Tuned</h2>

        <div class="mb-6">
            <label class="block text-white font-semibold mb-2">Fine-Tuned Model ID</label>
            <input type="text" id="compare-model-id"
                   class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none"
                   placeholder="ft:gpt-3.5-turbo:...">
        </div>

        <div class="mb-6">
            <label class="block text-white font-semibold mb-2">Test Prompt</label>
            <textarea id="compare-prompt" rows="3"
                      class="w-full px-4 py-3 bg-black/50 border border-white/20 rounded-xl text-white focus:border-pink-500 focus:outline-none"
                      placeholder="Tell me about traffic"></textarea>
        </div>

        <button onclick="compareModels()" class="w-full px-8 py-4 rounded-xl font-semibold text-black transition-all"
                style="background: linear-gradient(135deg, #FF6B9D, #FF1B7A); box-shadow: 0 4px 20px rgba(255, 107, 157, 0.3);">
            üîç Compare Responses
        </button>

        <div id="compare-result" class="mt-6 hidden"></div>
    </div>
</div>

<!-- Explain Tab -->
<div id="content-explain" class="tab-content">
    <div class="stage-container rounded-3xl p-8 max-w-5xl mx-auto curtain-reveal" style="animation-delay: 0.2s;">
        <div id="explain-content">
            <div class="text-center py-8">
                <div class="animate-spin inline-block w-8 h-8 border-4 border-pink-500 border-t-transparent rounded-full"></div>
                <p class="text-gray-400 mt-4">Loading explanation...</p>
            </div>
        </div>
    </div>
</div>

<style>
.tab-btn {
    padding: 0.75rem 1.5rem;
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 0.75rem;
    color: #9CA3AF;
    font-weight: 600;
    transition: all 0.3s;
    cursor: pointer;
}

.tab-btn:hover {
    background: rgba(255, 107, 157, 0.1);
    border-color: rgba(255, 107, 157, 0.3);
    color: #FF6B9D;
}

.tab-btn.active {
    background: linear-gradient(135deg, #FF6B9D, #FF1B7A);
    border-color: transparent;
    color: black;
    box-shadow: 0 4px 20px rgba(255, 107, 157, 0.3);
}

.tab-content {
    display: none;
}

.tab-content.active {
    display: block;
}

.job-card {
    background: rgba(0, 0, 0, 0.3);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 1rem;
    padding: 1.5rem;
    margin-bottom: 1rem;
    transition: all 0.3s;
}

.job-card:hover {
    background: rgba(255, 107, 157, 0.05);
    border-color: rgba(255, 107, 157, 0.2);
}

.status-badge {
    display: inline-block;
    padding: 0.25rem 0.75rem;
    border-radius: 9999px;
    font-size: 0.875rem;
    font-weight: 600;
}

.status-pending { background: rgba(59, 130, 246, 0.2); color: #60A5FA; }
.status-running { background: rgba(251, 191, 36, 0.2); color: #FCD34D; }
.status-completed { background: rgba(34, 197, 94, 0.2); color: #4ADE80; }
.status-failed { background: rgba(239, 68, 68, 0.2); color: #F87171; }
</style>

<script>
// Tab switching
function showTab(tabName) {
    // Hide all tabs
    document.querySelectorAll('.tab-content').forEach(content => {
        content.classList.remove('active');
    });
    document.querySelectorAll('.tab-btn').forEach(btn => {
        btn.classList.remove('active');
    });

    // Show selected tab
    document.getElementById(`content-${tabName}`).classList.add('active');
    document.getElementById(`tab-${tabName}`).classList.add('active');

    // Load data for specific tabs
    if (tabName === 'dataset') loadDatasetStats();
    if (tabName === 'jobs') loadJobs();
    if (tabName === 'explain') loadExplanation();
}

// Load dataset statistics
async function loadDatasetStats() {
    try {
        const response = await fetch('/fine-tuning/dataset-stats');
        const data = await response.json();

        let html = '';
        if (!data.exists) {
            html = `
                <div class="bg-yellow-500/10 border border-yellow-500/30 rounded-xl p-6 mb-6">
                    <h3 class="text-xl font-bold text-yellow-400 mb-2">‚ö†Ô∏è Dataset Not Found</h3>
                    <p class="text-gray-300 mb-4">${data.message}</p>
                    <p class="text-gray-400">Run this command to generate the dataset:</p>
                    <code class="block bg-black/50 p-3 rounded-lg mt-2 text-pink-400">python scripts/prepare_fine_tuning.py</code>
                </div>
            `;
        } else {
            const readyIcon = data.ready_for_training ? '‚úÖ' : '‚ö†Ô∏è';
            const readyColor = data.ready_for_training ? 'green' : 'yellow';

            html = `
                <div class="grid grid-cols-1 md:grid-cols-3 gap-4 mb-6">
                    <div class="bg-black/30 rounded-xl p-6 border border-white/10 text-center">
                        <div class="text-4xl mb-2" style="color: #FF6B9D;">üìä</div>
                        <div class="text-3xl font-bold text-white">${data.training_examples}</div>
                        <div class="text-gray-400 text-sm">Training Examples</div>
                    </div>
                    <div class="bg-black/30 rounded-xl p-6 border border-white/10 text-center">
                        <div class="text-4xl mb-2" style="color: #FF6B9D;">üíæ</div>
                        <div class="text-3xl font-bold text-white">${data.file_size_kb} KB</div>
                        <div class="text-gray-400 text-sm">File Size</div>
                    </div>
                    <div class="bg-black/30 rounded-xl p-6 border border-white/10 text-center">
                        <div class="text-4xl mb-2">${readyIcon}</div>
                        <div class="text-xl font-bold text-white">Ready</div>
                        <div class="text-gray-400 text-sm">${data.ready_for_training ? 'Yes' : 'Not yet'}</div>
                    </div>
                </div>
                <div class="bg-${readyColor}-500/10 border border-${readyColor}-500/30 rounded-xl p-4">
                    <p class="text-${readyColor}-300">${data.recommendation}</p>
                </div>
            `;
        }

        document.getElementById('dataset-stats').innerHTML = html;
    } catch (error) {
        document.getElementById('dataset-stats').innerHTML = `
            <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-6">
                <p class="text-red-300">Error loading dataset stats: ${error.message}</p>
            </div>
        `;
    }
}

// Training form submission
document.getElementById('training-form').addEventListener('submit', async (e) => {
    e.preventDefault();

    const modelName = document.getElementById('model-name').value;
    const epochs = parseInt(document.getElementById('epochs').value);
    const batchSize = parseInt(document.getElementById('batch-size').value);
    const learningRate = parseFloat(document.getElementById('learning-rate').value);

    const resultDiv = document.getElementById('training-result');
    resultDiv.innerHTML = `
        <div class="bg-blue-500/10 border border-blue-500/30 rounded-xl p-6">
            <div class="flex items-center">
                <div class="animate-spin w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full mr-3"></div>
                <p class="text-blue-300">Starting fine-tuning job...</p>
            </div>
        </div>
    `;
    resultDiv.classList.remove('hidden');

    try {
        const response = await fetch('/fine-tuning/start', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({
                model_name: modelName,
                hyperparameters: {
                    n_epochs: epochs,
                    batch_size: batchSize,
                    learning_rate_multiplier: learningRate
                }
            })
        });

        const data = await response.json();

        if (data.success) {
            resultDiv.innerHTML = `
                <div class="bg-green-500/10 border border-green-500/30 rounded-xl p-6">
                    <h3 class="text-xl font-bold text-green-400 mb-3">‚úÖ Training Started!</h3>
                    <p class="text-gray-300 mb-2"><strong>Job ID:</strong> ${data.job_id}</p>
                    <p class="text-gray-300 mb-2"><strong>Model Name:</strong> ${data.model_name}</p>
                    <p class="text-gray-300 mb-4"><strong>Status:</strong> ${data.status}</p>
                    <p class="text-gray-400 text-sm">${data.message}</p>
                </div>
            `;
        } else {
            throw new Error(data.error || 'Unknown error');
        }
    } catch (error) {
        resultDiv.innerHTML = `
            <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-6">
                <h3 class="text-xl font-bold text-red-400 mb-2">‚ùå Error</h3>
                <p class="text-red-300">${error.message}</p>
            </div>
        `;
    }
});

// Load jobs
async function loadJobs() {
    try {
        const response = await fetch('/fine-tuning/jobs');
        const data = await response.json();

        if (data.jobs.length === 0) {
            document.getElementById('jobs-list').innerHTML = `
                <div class="text-center py-12">
                    <div class="text-6xl mb-4">üìã</div>
                    <p class="text-gray-400">No fine-tuning jobs yet. Start one in the Training tab!</p>
                </div>
            `;
            return;
        }

        let html = '';
        data.jobs.forEach(job => {
            const statusClass = `status-${job.status || 'pending'}`;
            html += `
                <div class="job-card">
                    <div class="flex justify-between items-start mb-3">
                        <div>
                            <h3 class="text-xl font-bold text-white">${job.model_name || 'Unnamed Model'}</h3>
                            <p class="text-gray-400 text-sm">${job.job_id}</p>
                        </div>
                        <span class="status-badge ${statusClass}">${job.status}</span>
                    </div>
                    <div class="grid grid-cols-2 gap-4 text-sm">
                        <div>
                            <p class="text-gray-400">Base Model</p>
                            <p class="text-white">${job.base_model || 'N/A'}</p>
                        </div>
                        <div>
                            <p class="text-gray-400">Created</p>
                            <p class="text-white">${new Date(job.created_at).toLocaleString()}</p>
                        </div>
                    </div>
                    ${job.fine_tuned_model ? `
                        <div class="mt-3 pt-3 border-t border-white/10">
                            <p class="text-gray-400 text-sm">Fine-Tuned Model ID:</p>
                            <code class="text-pink-400 text-sm">${job.fine_tuned_model}</code>
                        </div>
                    ` : ''}
                </div>
            `;
        });

        document.getElementById('jobs-list').innerHTML = html;
    } catch (error) {
        document.getElementById('jobs-list').innerHTML = `
            <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-6">
                <p class="text-red-300">Error loading jobs: ${error.message}</p>
            </div>
        `;
    }
}

// Chat with model
async function sendChatMessage() {
    const modelId = document.getElementById('chat-model-id').value;
    const message = document.getElementById('chat-message').value;
    const comedian = document.getElementById('chat-comedian').value;

    if (!modelId || !message) {
        alert('Please fill in both fields');
        return;
    }

    const resultDiv = document.getElementById('chat-response');
    resultDiv.innerHTML = `
        <div class="bg-blue-500/10 border border-blue-500/30 rounded-xl p-6">
            <div class="flex items-center">
                <div class="animate-spin w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full mr-3"></div>
                <p class="text-blue-300">Getting response...</p>
            </div>
        </div>
    `;
    resultDiv.classList.remove('hidden');

    try {
        const response = await fetch('/fine-tuning/chat', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ model_id: modelId, message: message, comedian: comedian })
        });

        const data = await response.json();

        if (data.response) {
            resultDiv.innerHTML = `
                <div class="bg-black/30 border border-white/10 rounded-xl p-6">
                    <h3 class="text-lg font-bold text-white mb-3">ü§ñ Response</h3>
                    <p class="text-gray-300 leading-relaxed mb-4">${data.response}</p>
                    <div class="text-sm text-gray-400">
                        <p>Model: ${data.model}</p>
                        <p>Tokens: ${data.usage.total_tokens}</p>
                        <p>Time: ${data.response_time_ms}ms</p>
                    </div>
                </div>
            `;
        } else {
            throw new Error(data.error || 'Unknown error');
        }
    } catch (error) {
        resultDiv.innerHTML = `
            <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-6">
                <p class="text-red-300">Error: ${error.message}</p>
            </div>
        `;
    }
}

// Compare models
async function compareModels() {
    const modelId = document.getElementById('compare-model-id').value;
    const prompt = document.getElementById('compare-prompt').value;

    if (!modelId || !prompt) {
        alert('Please fill in both fields');
        return;
    }

    const resultDiv = document.getElementById('compare-result');
    resultDiv.innerHTML = `
        <div class="bg-blue-500/10 border border-blue-500/30 rounded-xl p-6">
            <div class="flex items-center">
                <div class="animate-spin w-6 h-6 border-4 border-blue-500 border-t-transparent rounded-full mr-3"></div>
                <p class="text-blue-300">Comparing models...</p>
            </div>
        </div>
    `;
    resultDiv.classList.remove('hidden');

    try {
        const response = await fetch('/fine-tuning/compare', {
            method: 'POST',
            headers: { 'Content-Type': 'application/json' },
            body: JSON.stringify({ fine_tuned_model: modelId, prompt: prompt })
        });

        const data = await response.json();

        if (data.comparison) {
            resultDiv.innerHTML = `
                <div class="grid grid-cols-1 md:grid-cols-2 gap-6">
                    <div class="bg-black/30 border border-white/10 rounded-xl p-6">
                        <h3 class="text-lg font-bold text-white mb-3">üîπ Base Model</h3>
                        <p class="text-gray-400 text-sm mb-2">${data.comparison.base_model.model}</p>
                        <p class="text-gray-300 leading-relaxed">${data.comparison.base_model.response}</p>
                        <p class="text-gray-400 text-sm mt-3">Tokens: ${data.comparison.base_model.tokens}</p>
                    </div>
                    <div class="bg-black/30 border border-pink-500/20 rounded-xl p-6">
                        <h3 class="text-lg font-bold text-white mb-3">‚ú® Fine-Tuned Model</h3>
                        <p class="text-gray-400 text-sm mb-2">${data.comparison.fine_tuned.model}</p>
                        <p class="text-gray-300 leading-relaxed">${data.comparison.fine_tuned.response}</p>
                        <p class="text-gray-400 text-sm mt-3">Tokens: ${data.comparison.fine_tuned.tokens}</p>
                    </div>
                </div>
            `;
        } else {
            throw new Error(data.error || 'Unknown error');
        }
    } catch (error) {
        resultDiv.innerHTML = `
            <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-6">
                <p class="text-red-300">Error: ${error.message}</p>
            </div>
        `;
    }
}

// Load explanation
async function loadExplanation() {
    try {
        const response = await fetch('/fine-tuning/explain');
        const data = await response.json();

        let html = `
            <h2 class="text-3xl font-bold text-white mb-6">${data.concept}</h2>

            <div class="bg-black/30 rounded-xl p-6 mb-6 border border-white/10">
                <h3 class="text-xl font-bold text-white mb-3">What is Fine-Tuning?</h3>
                <p class="text-gray-300 leading-relaxed">${data.what_it_is}</p>
            </div>

            <div class="bg-black/30 rounded-xl p-6 mb-6 border border-white/10">
                <h3 class="text-xl font-bold text-white mb-4">How It Works</h3>
                <div class="space-y-4">
        `;

        data.how_it_works.forEach(step => {
            html += `
                <div class="flex gap-4">
                    <div class="flex-shrink-0 w-8 h-8 bg-pink-500 rounded-full flex items-center justify-center text-black font-bold">
                        ${step.step}
                    </div>
                    <div>
                        <h4 class="font-bold text-white">${step.title}</h4>
                        <p class="text-gray-400 text-sm">${step.description}</p>
                    </div>
                </div>
            `;
        });

        html += `
                </div>
            </div>

            <div class="grid grid-cols-1 md:grid-cols-2 gap-6 mb-6">
                <div class="bg-green-500/10 rounded-xl p-6 border border-green-500/30">
                    <h3 class="text-xl font-bold text-green-400 mb-3">‚úÖ Benefits</h3>
                    <ul class="space-y-2 text-gray-300">
        `;

        data.benefits.forEach(benefit => {
            html += `<li class="flex items-start"><span class="mr-2">‚Ä¢</span><span>${benefit}</span></li>`;
        });

        html += `
                    </ul>
                </div>
                <div class="bg-red-500/10 rounded-xl p-6 border border-red-500/30">
                    <h3 class="text-xl font-bold text-red-400 mb-3">‚ö†Ô∏è Drawbacks</h3>
                    <ul class="space-y-2 text-gray-300">
        `;

        data.drawbacks.forEach(drawback => {
            html += `<li class="flex items-start"><span class="mr-2">‚Ä¢</span><span>${drawback}</span></li>`;
        });

        html += `
                    </ul>
                </div>
            </div>

            <div class="bg-blue-500/10 rounded-xl p-6 border border-blue-500/30">
                <h3 class="text-xl font-bold text-blue-400 mb-3">üí° When to Use</h3>
                <p class="text-gray-300 leading-relaxed">${data.when_to_use}</p>
            </div>
        `;

        document.getElementById('explain-content').innerHTML = html;
    } catch (error) {
        document.getElementById('explain-content').innerHTML = `
            <div class="bg-red-500/10 border border-red-500/30 rounded-xl p-6">
                <p class="text-red-300">Error loading explanation: ${error.message}</p>
            </div>
        `;
    }
}

// Load dataset stats on page load
loadDatasetStats();
</script>
{% endblock %}
